# file: app/pages/help_page.py

from PyQt6.QtWidgets import QWidget, QVBoxLayout, QTextBrowser
from PyQt6.QtCore import Qt

class HelpPage(QWidget):
    def __init__(self):
        super().__init__()
        layout = QVBoxLayout(self)
        layout.setContentsMargins(25, 25, 25, 25)

        text_browser = QTextBrowser()
        text_browser.setReadOnly(True)
        text_browser.setOpenExternalLinks(True)
        text_browser.setHtml(self.get_help_html())

        layout.addWidget(text_browser)
        self.setLayout(layout)

    def get_help_html(self):

        return"""
                  <!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <style>
        body { 
            font-family: 'Tahoma', sans-serif; 
            font-size: 14px; 
            line-height: 1.8; 
            color: #333;
            background-color: #fdfdfd;
        }
        h1 { 
            color: #2c3e50; 
            font-size: 24px;
            text-align: center;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        h2 { 
            color: #34495e; 
            font-size: 20px;
            border-bottom: 1px solid #bdc3c7; 
            padding-bottom: 8px;
            margin-top: 30px;
        }
        h3 { 
            color: #2980b9; 
            font-size: 16px;
            margin-top: 25px;
        }
        p { 
            text-align: justify; 
            margin-bottom: 15px;
        }
        ul, ol { 
            padding-right: 20px;
        }
        li {
            margin-bottom: 10px;
        }
        strong {
            color: #c0392b;
        }
        code { 
            background-color: #ecf0f1; 
            padding: 2px 6px; 
            border-radius: 4px; 
            font-family: 'Consolas', 'Courier New', monospace;
            color: #2c3e50;
            border: 1px solid #bdc3c7;
        }
        .note {
            background-color: #eaf5ff;
            border-right: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>راهنمای کاربری نرم‌افزار OptiWise</h1>
    <div class="note">
        <strong>نام OptiWise به چه معناست؟</strong><br>
        این نام از ترکیب دو واژه <b>Opti</b> (برگرفته از Optimize به معنای بهینه‌سازی) و <b>Wise</b> (به معنای خردمندانه) ساخته شده است. هدف این نرم‌افزار، کمک به شما برای گرفتن <b>تصمیمات خردمندانه</b> از طریق <b>بهینه‌سازی</b> و تحلیل کارایی است.
    </div>
    <h2>مقدمه</h2>
    <p>
        نرم‌افزار <strong>OptiWise</strong> یک ابزار قدرتمند برای تحلیل داده و پشتیبانی از تصمیم‌گیری است. این سیستم به مدیران و تحلیل‌گران کمک می‌کند تا با استفاده از روش‌های علمی پیشرفته، عملکرد واحدهای مختلف سازمان خود را ارزیابی، مقایسه و رتبه‌بندی کنند. این نرم‌افزار شامل چهار ماژول اصلی است: <strong>تحلیل خوشه‌بندی</strong>، <strong>محاسبه بهره‌وری واحدها</strong>، <strong>رتبه‌بندی واحدها</strong> و <strong>بهره‌وری نیروی انسانی</strong>.
    </p>

    <h2>بخش اول: مفاهیم علمی و الگوریتم‌ها</h2>
    <p>این بخش به صورت ساده، مفاهیمی را که نرم‌افزار بر اساس آن‌ها کار می‌کند، توضیح می‌دهد.</p>

    <h3>۱. تحلیل خوشه‌بندی (Clustering)</h3>
    <ul>
        <li><strong>هدف چیست؟</strong> هدف از خوشه‌بندی، گروه‌بندی واحدهای مشابه (که در اینجا <strong>واحد تصمیم‌گیرنده یا DMU</strong> نامیده می‌شوند) در دسته‌های جداگانه است. این کار به شما اجازه می‌دهد تا واحدهایی که ساختار و ویژگی‌های یکسانی دارند را با یکدیگر مقایسه کنید (مقایسه سیب با سیب).</li>
        <li><strong>الگوریتم‌های مورد استفاده:</strong>
            <ul>
                <li><code>K-Means</code>: الگوریتمی سریع و محبوب که واحدها را بر اساس نزدیک‌ترین "مرکز خوشه" گروه‌بندی می‌کند.</li>
                <li><code>K-Medoids</code>: شبیه به K-Means است، اما به جای یک مرکز خوشه فرضی، یکی از واحدهای واقعی را به عنوان نماینده خوشه انتخاب می‌کند که آن را در مقابل داده‌های پرت مقاوم‌تر می‌سازد.</li>
                <li><code>Ward</code>: یک روش سلسله‌مراتبی که با ادغام نزدیک‌ترین خوشه‌ها، ساختار درختی از گروه‌ها ایجاد می‌کند و برای یافتن خوشه‌های فشرده و همگن بسیار مناسب است.</li>
            </ul>
        </li>
        <li><strong>چگونه بهترین مدل انتخاب می‌شود؟</strong> نرم‌افزار به طور خودکار دو معیار آماری را محاسبه می‌کند:
            <ul>
                <li><strong>امتیاز سیلوئت (Silhouette):</strong> نشان می‌دهد که هر واحد چقدر به خوشه خود شبیه و از خوشه‌های دیگر متمایز است (مقدار بالاتر بهتر است).</li>
                <li><strong>شاخص دیویس-بولدین (Davies-Bouldin):</strong> فشردگی درون خوشه‌ها و جدایی بین خوشه‌ها را می‌سنجد (مقدار پایین‌تر بهتر است).</li>
            </ul>
        </li>
    </ul>

    <h3>۲. تحلیل پوششی داده‌ها (DEA) برای محاسبه بهره‌وری</h3>
    <ul>
        <li><strong>هدف چیست؟</strong> بهره‌وری به زبان ساده یعنی "چقدر خروجی از ورودی‌های موجود به دست آورده‌ایم". DEA یک روش ریاضی قدرتمند برای اندازه‌گیری بهره‌وری واحدهایی است که چندین ورودی و چندین خروجی دارند. مزیت بزرگ DEA این است که نیازی به تعیین وزن برای شاخص‌ها ندارد.</li>
        <li><strong>مدل مورد استفاده:</strong>
            <ul>
                <li><strong>مدل SBM (Slack-Based Model):</strong> این نرم‌افزار از یک مدل پیشرفته به نام SBM استفاده می‌کند که نه تنها کارایی واحدها را بین ۰ تا ۱ مشخص می‌کند، بلکه <strong>میزان کمبود (Slack)</strong> در ورودی‌ها را نیز نشان می‌دهد. این کمبودها به شما می‌گویند که یک واحد ناکارا برای رسیدن به مرز کارایی، چقدر باید از ورودی‌های خود بکاهد.</li>
                <li><strong>مجموعه مرجع (Peers):</strong> هر واحد ناکارا با ترکیبی از بهترین واحدهای کارا (که "مجموعه مرجع" آن نامیده می‌شوند) مقایسه می‌شود. نرم‌افزار این واحدهای الگو را برای شما مشخص می‌کند.</li>
            </ul>
        </li>
    </ul>

    <h3>۳. رتبه‌بندی واحدها (Super-Efficiency)</h3>
    <ul>
        <li><strong>چالش چیست؟</strong> در مدل‌های استاندارد DEA، تمام واحدهای کارا امتیاز یکسان (معمولاً ۱) می‌گیرند و نمی‌توان آن‌ها را رتبه‌بندی کرد.</li>
        <li><strong>راه حل چیست؟</strong> مدل <strong>ابرکارایی (Super-Efficiency)</strong> این مشکل را حل می‌کند. در این مدل، هر واحد کارا به طور موقت از مجموعه مرجع خود خارج شده و کارایی آن نسبت به بقیه سنجیده می‌شود. این کار اجازه می‌دهد تا واحدهای کارا امتیازی <strong>بیشتر از ۱</strong> کسب کنند. هرچه این امتیاز بالاتر باشد، آن واحد کاراتر و در رتبه بالاتری قرار دارد.</li>
    </ul>
    
    <h3>۴. بهره‌وری نیروی انسانی</h3>
    <ul>
        <li><strong>هدف چیست؟</strong> این ماژول به طور خاص برای ارزیابی عملکرد و بهره‌وری افراد (کارمندان، کارشناسان و...) طراحی شده است.</li>
        <li><strong>مدل مورد استفاده:</strong>
            <ul>
                <li><strong>مدل BCC:</strong> این ماژول از مدل کلاسیک BCC استفاده می‌کند که برای تحلیل بهره‌وری در شرایطی که مقیاس عملیات واحدها متفاوت است (مثلاً مقایسه یک کارشناس تازه‌کار با یک کارشناس ارشد) بسیار مناسب است.</li>
            </ul>
        </li>
    </ul>

    <h2>بخش دوم: راهنمای گام به گام کار با نرم‌افزار</h2>
    <p>رابط کاربری نرم‌افزار از یک منو در سمت راست برای جابجایی بین ماژول‌ها و یک صفحه اصلی در سمت چپ برای نمایش محتوا تشکیل شده است.</p>

    <h3>ماژول ۱: تحلیل خوشه‌بندی</h3>
    <ol>
        <li><strong>قدم اول: بارگذاری داده:</strong>
            <ul>
                <li>بر روی دکمه <strong>"انتخاب فایل اکسل"</strong> کلیک کنید. فایل شما باید ستون اول را به نام واحدها (DMU) و ستون‌های بعدی را به شاخص‌های عددی اختصاص دهد.</li>
                <li>می‌توانید با کلیک بر روی <strong>"دانلود قالب اکسل"</strong> یک نمونه فایل دریافت کنید.</li>
            </ul>
        </li>
        <li><strong>قدم دوم: انتخاب شاخص‌ها:</strong> از لیستی که ظاهر می‌شود، شاخص‌هایی را که می‌خواهید اساس خوشه‌بندی باشند، تیک بزنید.</li>
        <li><strong>قدم سوم: اجرای تحلیل:</strong> روی دکمه <strong>"اجرای تمام تحلیل‌ها"</strong> کلیک کنید.</li>
        <li><strong>قدم چهارم: مشاهده نتایج:</strong>
            <ul>
                <li>در جدول بالا <strong>"مقایسه نتایج"</strong>، تمام مدل‌ها با الگوریتم‌ها و تعداد خوشه‌های مختلف به همراه امتیازهایشان نمایش داده می‌شوند. مدل‌ها بر اساس کیفیت مرتب شده‌اند.</li>
                <li>با کلیک بر روی هر سطر از این جدول، در جدول پایین <strong>"جزئیات خوشه‌بندی"</strong>، می‌توانید ببینید که هر واحد در کدام خوشه قرار گرفته است.</li>
            </ul>
        </li>
    </ol>
    <div class="note">
        <strong>نکته مهم:</strong> نتایج بهترین مدل خوشه‌بندی به صورت خودکار برای استفاده در ماژول "محاسبه بهره‌وری" ذخیره می‌شود تا بتوانید تحلیل‌ها را به صورت گروه‌بندی شده مشاهده کنید.
    </div>

    <h3>ماژول ۲: محاسبه بهره‌وری واحد (DEA)</h3>
    <ol>
        <li><strong>قدم اول: بارگذاری داده:</strong> فایل اکسل مربوط به داده‌های بهره‌وری (ورودی‌ها و خروجی‌ها) را انتخاب کنید.</li>
        <li><strong>قدم دوم: انتخاب ورودی و خروجی:</strong>
            <ul>
                <li>از لیست <strong>"ورودی‌ها"</strong>، ستون‌هایی را که نقش ورودی دارند، انتخاب کنید.</li>
                <li>از لیست <strong>"خروجی‌ها"</strong>، ستون‌هایی را که نقش خروجی دارند، انتخاب کنید.</li>
                <li>(می‌توانید از چک‌باکس "همه" برای انتخاب سریع استفاده کنید).</li>
            </ul>
        </li>
        <li><strong>قدم سوم: اجرای تحلیل:</strong> بر روی دکمه <strong>"محاسبه بهره‌وری"</strong> کلیک کنید.</li>
        <li><strong>قدم چهارم: مشاهده نتایج:</strong>
            <ul>
                <li>جدول نتایج شامل <strong>امتیاز بهره‌وری</strong>، <strong>میزان کمبود (اسلک)</strong> برای هر ورودی و <strong>مجموعه مرجع</strong> برای هر واحد است.</li>
                <li><strong>قابلیت ویژه:</strong> اگر تحلیل خوشه‌بندی را قبلاً انجام داده باشید، یک منوی کشویی در بالای جدول نتایج فعال می‌شود. شما می‌توانید با انتخاب مدل خوشه‌بندی مورد نظر، نتایج بهره‌وری را به تفکیک خوشه‌ها مشاهده کنید. این کار مقایسه واحدهای هم‌گروه را بسیار ساده می‌کند.</li>
            </ul>
        </li>
    </ol>

    <h3>ماژول ۳: رتبه‌بندی واحدها (Super-Efficiency)</h3>
    <p>فرایند کار با این ماژول دقیقاً مشابه ماژول محاسبه بهره‌وری است:</p>
    <ol>
        <li>فایل داده را بارگذاری کنید.</li>
        <li>ورودی‌ها و خروجی‌ها را انتخاب کنید.</li>
        <li>روی دکمه <strong>"محاسبه رتبه‌بندی"</strong> کلیک کنید.</li>
        <li>در جدول نتایج، ستون <strong>"امتیاز ابرکارایی"</strong> را مشاهده کنید. واحدها به صورت نزولی بر اساس این امتیاز رتبه‌بندی شده‌اند. امتیازی بالاتر از ۱ به معنای کارایی برتر است.</li>
    </ol>
    
    <h3>ماژول ۴: بهره‌وری نیروی انسانی</h3>
    <p>این ماژول نیز فرایندی مشابه دو ماژول قبلی دارد:</p>
    <ol>
        <li>فایل داده پرسنل را بارگذاری کنید.</li>
        <li>شاخص‌های ورودی (مانند سابقه کار، میزان تحصیلات) و خروجی (مانند تعداد پروژه‌های موفق، امتیاز عملکرد) را انتخاب کنید.</li>
        <li>روی دکمه <strong>"محاسبه بهره‌وری پرسنل"</strong> کلیک کنید.</li>
        <li>نتایج در جدول نمایش داده می‌شود. اگر فایل شما ستون‌هایی مانند "کد پرسنلی" یا "نام و نام خانوادگی" داشته باشد، آن‌ها نیز برای شناسایی بهتر در جدول نتایج نمایش داده خواهند شد.</li>
    </ol>
</body>
</html>

              """